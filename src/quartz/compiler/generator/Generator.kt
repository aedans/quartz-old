package quartz.compiler.generator

import quartz.compiler.generator.semantics.unwrapExpressions
import quartz.compiler.generator.semantics.verifyNames
import quartz.compiler.tree.Program
import java.io.OutputStream

/**
 * Created by Aedan Smith.
 */

object Generator {
    fun write(program: Program, outputStream: OutputStream) {
        val newProgramNode = program
                .unwrapExpressions()
                .verifyNames()
        val cStream = ProgramOutputStream(newProgramNode, outputStream)
        cStream.declare("header") {
            comment("Generated by the Quartz compiler")
        }
        cStream.writeAll()
    }
}
